<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Game Frame</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" src="lib/jquery-1.11.0.js"></script>
    <script type="text/javascript" src="src/HTMLFormatter.js"></script>
    <script type="text/javascript" src="src/Interact.js"></script>
    <script type="text/javascript" src="src/response_lib.js"></script>
    <script type="text/javascript" src="src/rif_dom.js"></script>
    <script type="text/javascript" src="src/rif_expand.js"></script>
    <script type="text/javascript" src="src/rif_parse.js"></script>
    <script type="text/javascript" src="src/rif_tokenize.js"></script>

    <script type="text/javascript">
        function init() {
            var rifSource = $.ajax({
                url: "data/sample_rif.txt",
                async: false
            }).responseText;

            var tokens = rifTokenize(rifSource);
            tokens = rifExpand(tokens);
            var rif  = rifParse(tokens);

            var world = {};

            var dom = new RifDOM($('#output'));
            var formatter = new HTMLFormatter();
            var clickFactory = function(keyword) {
                return function () {
                    world.sendCommand(keyword);
                };
            };
            var interact = new Interact(dom, formatter, clickFactory);

            var response_lib = new ResponseLib(interact);
            world.sendCommand = function(keyword) {
                response_lib.callTopics({general: rif.responses.room}, [keyword], "me");
                interact.say({text: "{break}"});
            };
            world.sendCommand("LOOK");
        }
    </script>
</head>
<body onLoad="init()">
    <div id="header">This is the header</div>
    <div id="holder">
        <div id="spacer"></div>
        <div id="output"></div>
    </div>
</body>
</html>
