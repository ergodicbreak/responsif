.define expandandfadein .transition expand fadein .enddef
.define fadein .transition fadein .enddef
.responses room
	.response
		.matches LOOK
		.runs 1
		.does
			.says
				<div id="intro">
					<div id="introfadefirst">
						<div id="introrain"></div>
						<div id="introwind"></div>
					</div>
					<div id="introdream">{!You dream.|INTRODREAM!}<div id="introdream1"></div><div id="introdream2"></div></div>
				</div>
			.animates #intro .to {"opacity": 0.0}
			.animates #intro .to {"opacity": 1.0} .lasting 1000
	.response
		.matches INTRODREAM
		.runs 2
		.does 1
				.says {!The patter of rain|INTRORAIN!}<div id="rainpunc">.</div> <div id="introrain2"></div> .into #introrain
				.says {!A caress of wind|INTROWIND!}<div id="windpunc">.</div> <div id="introwind2"></div> .into #introwind
				.says {!..|INTRODREAM!} .into #introdream1
				.animates #introrain, #introwind, #introdream1 .to {"font-size": "0%", "opacity": "0"}
				.animates #introrain, #introwind, #introdream1 .to {"font-size": "100%"} .lasting 1000
				.animates #introrain, #introwind, #introdream1 .to {"opacity": "1"} .lasting 1000
		.does 2 .says but you should not dream. .into #introdream2
				.animates #introdream2 .to {"opacity": 0.0}
				.animates #introdream2 .to {"opacity": 1.0} .lasting 1000
				.sets intro_saw_dream
				.calls INTRODONE

	.response
		.matches INTRORAIN 
		.runs 1
		.does
			.says , .into #rainpunc
			.says but there is no rain. .expandandfadein .into #introrain2
			.sets intro_saw_rain
			.calls INTRODONE
	.response
		.matches INTROWIND
		.runs 1 
		.does
			.says , .into #windpunc
			.says but there is no wind. .expandandfadein .into #introwind2
			.sets intro_saw_wind
			.calls INTRODONE
		
	.response
		.matches INTRODONE
		.needs intro_saw_dream intro_saw_rain intro_saw_wind
		.does
			.says Next...
			.animates #introfadefirst .to { "opacity": 0.2 } .lasting 2000
			.animates #introdream .to { "opacity": 1 } .lasting 2000
			.animates #introdream .to { "opacity": 0.2 } .lasting 4000
.end
