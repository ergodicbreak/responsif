<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Meek</title>
    <link rel="stylesheet" href="style.css" type="text/css">
    <script type="text/javascript" src="lib/jquery-1.11.0.js"></script>
    <script src="//code.jquery.com/ui/1.11.2/jquery-ui.js"></script>
    <script type="text/javascript" src="src/HTMLFormatter.js"></script>
    <script type="text/javascript" src="src/rif_interact.js"></script>
    <script type="text/javascript" src="src/response_lib.js"></script>
    <script type="text/javascript" src="src/rif_dom.js"></script>
    <script type="text/javascript" src="src/rif_expand.js"></script>
    <script type="text/javascript" src="src/rif_parse.js"></script>
    <script type="text/javascript" src="src/rif_tokenize.js"></script>
    <script type="text/javascript" src="src/rif_world.js"></script>

    <script type="text/javascript">
        function loadRif(file, world) {
            var rifSource = $.ajax({
                url: "data/" + file,
                async: false
            }).responseText;

            var tokens = rifTokenize(rifSource);
            tokens = rifExpand(tokens);
            rif = rifParse(tokens);
            world.addRif(rif);
            return rif;
        }
        function createInteract(world) {
            var dom = new RifDOM($('#output'));
            var formatter = new HTMLFormatter();
            var interact = new RifInteract(dom, formatter, world);
            return interact;
        }
        function init() {
            var world = new RifWorld();

            var rif = loadRif("sample_rif.txt", world);
            var interact = createInteract(world);
            var response_lib = new ResponseLib(interact);

            world.callTopics = function(topics) {
                response_lib.callTopics({general: rif.responses.room}, topics, "me");
            };
            interact.sendCommand(["LOOK"]);
        }
    </script>
</head>
<body onLoad="init()">
    <div id="holder">
        <div id="spacer"></div>
        <div id="output"></div>
        <div id="barspacer"></div>
        <div id="footer">
            <div id="bar">
                <div id="barLeftHolder"><span id="commandPane"></span></div>
                <div id="barRightHolder"><span id="helpPane"></span></div>
            </div>
            <div style="font-size:12pt;"><br></div>
        </div>
    </div>
</body>
</html>
